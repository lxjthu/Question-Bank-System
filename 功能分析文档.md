# 林业经济学（双语）试题管理系统 - 功能分析文档

## 项目概述

本项目是一个完整的林业经济学试题管理系统，支持双语（中英文）试题管理、试卷生成等功能。系统采用前后端分离架构，使用Flask作为后端框架，HTML/CSS/JavaScript作为前端界面。

## 已实现功能

### 1. 后端功能 (web_server.py)

#### 1.1 题库管理API
- `GET /api/questions` - 获取所有题目
- `POST /api/questions` - 添加新题目
- `PUT /api/questions/<question_type>/<int:index>` - 更新题目
- `DELETE /api/questions/<question_type>/<int:index>` - 删除题目

#### 1.2 Word文档处理
- `POST /api/convert-word` - 上传并转换Word文档为题库
- `GET /api/download-template/<template_type>` - 下载题型模板

#### 1.3 题库导出
- `GET /api/export/json` - 导出题库为JSON格式
- `GET /api/export/csv` - 导出题库为CSV格式

#### 1.4 试卷生成
- `POST /api/generate-exam` - 根据配置生成试卷

#### 1.5 题目搜索
- `POST /api/search-questions` - 按关键词搜索题目

#### 1.6 试卷管理
- `POST /api/save-exam` - 保存试卷组卷
- `GET /api/load-exam/<exam_id>` - 加载保存的试卷
- `GET /api/list-saved-exams` - 列出所有保存的试卷
- `DELETE /api/delete-exam/<exam_id>` - 删除保存的试卷

### 2. 题目解析器 (word_to_csv_converter.py)

#### 2.1 题目解析功能
- 解析Word文档中的单选题、是非题、论述题、计算题
- 支持中英文双语题目
- 智能识别题目格式和缺失部分

#### 2.2 模板生成功能
- 生成单选题Word模板
- 生成是非题Word模板
- 生成论述题Word模板
- 生成计算题Word模板

#### 2.3 数据转换
- 将解析的题目保存为CSV格式
- 支持复杂题型结构（如选项、评分标准等）

### 3. 前端界面 (嵌入在web_server.py中)

#### 3.1 题库管理界面
- 添加新题目（支持4种题型）
- 编辑和删除现有题目
- 题目列表展示（包含使用统计）
- 导入Word文档转换为题库
- 导出题库为JSON/CSV格式

#### 3.2 试卷生成界面
- 配置各题型数量和分值
- 手动选择题目功能
- 试卷预览功能
- 试卷下载功能

#### 3.3 模板下载界面
- 提供4种题型的Word模板下载
- 详细的格式要求说明

## 系统架构

### 技术栈
- 后端：Python Flask
- 前端：HTML/CSS/JavaScript
- 文档处理：python-docx
- 数据存储：内存存储（可扩展为数据库）

### 数据结构

#### 题目数据结构
```json
{
  "single_choice_questions": [
    {
      "id": "sc_001",
      "type": "single_choice",
      "difficulty": "medium",
      "chinese_stem": "题目中文内容",
      "english_stem": "Question English Content",
      "options": {
        "A": "选项A中文",
        "A_en": "Option A English",
        "B": "选项B中文",
        "B_en": "Option B English",
        "C": "选项C中文",
        "C_en": "Option C English",
        "D": "选项D中文",
        "D_en": "Option D English"
      },
      "correct_answer": "A",
      "knowledge_point": "知识点",
      "tags": ["标签1", "标签2"]
    }
  ],
  "true_false_questions": [...],
  "essay_questions": [...],
  "calculation_questions": [...]
}
```

## 需要补充的功能

### 1. 数据持久化
- 当前使用内存存储，需要添加数据库支持（如SQLite/MySQL）
- 实现数据的持久化存储和备份功能

### 2. 用户认证和权限管理
- 添加用户登录/注册功能
- 实现不同用户角色（管理员、教师、学生）
- 权限控制机制

### 3. 高级试卷功能
- 试卷模板管理
- 题目难度分布控制
- 知识点覆盖率统计
- 试卷质量评估

### 4. 题目管理增强
- 题目分类和标签系统
- 题目版本控制
- 题目审核流程

### 5. 试卷导出格式增强
- 支持Word文档导出（当前仅支持文本）
- PDF格式导出
- 更好的格式控制

### 6. 搜索和过滤功能
- 高级搜索（按知识点、难度、标签等）
- 题目批量操作
- 智能推荐题目

### 7. 统计和分析
- 题目使用统计
- 试卷生成历史
- 教学效果分析

## 当前系统限制

1. 数据存储：使用内存存储，重启后数据丢失
2. 并发支持：单用户访问，无并发控制
3. 安全性：无用户认证和权限控制
4. 扩展性：功能模块耦合度较高

## 建议的改进方向

1. 添加数据库支持（推荐SQLite用于简单部署，MySQL用于生产环境）
2. 实现用户认证系统
3. 添加数据备份和恢复功能
4. 优化前端界面用户体验
5. 增加API文档和测试用例
6. 添加日志记录功能
7. 实现文件上传安全检查