# 林业经济学（双语）试题管理系统 - 系统架构说明

## 项目概述

本项目是一个基于Flask的林业经济学试题管理系统，支持双语（中英文）试题管理、试卷生成等功能。系统采用前后端分离架构，使用Flask作为后端框架，HTML/CSS/JavaScript作为前端界面。

## 当前文件架构

```
D:\code\试卷\
├── app/                          # 应用主目录
│   ├── __init__.py              # 包初始化文件
│   ├── models.py                # 数据模型定义
│   ├── routes.py                # API路由定义
│   ├── utils.py                 # 工具类和辅助函数
│   ├── factory.py               # 应用工厂
│   ├── templates/               # HTML模板目录
│   │   └── index.html           # 主页面模板
│   └── static/                  # 静态资源目录（预留）
├── config.py                    # 配置文件
├── server.py                    # 主服务器文件
├── word_to_csv_converter.py     # Word文档转换器
├── exam_system.html             # 独立的前端界面文件
├── web_server.py                # 原始的单文件服务器（已重构）
└── 系统架构说明.md               # 本文档
```

## 模块说明

### 1. app/models.py - 数据模型层
- 定义了题目数据结构（单选题、是非题、论述题、计算题）
- 定义了试卷类和相关业务实体
- 管理全局题目库、使用统计和保存的试卷

### 2. app/routes.py - 控制器层
- 定义所有API路由（RESTful接口）
- 处理题库管理、试卷生成、Word文档转换等业务逻辑
- 使用Flask蓝图组织路由

### 3. app/utils.py - 工具层
- 文件类型验证函数
- Word文档转换器封装
- 其他辅助函数

### 4. app/templates/index.html - 视图层
- 前端用户界面
- 包含题库管理、试卷生成、模板下载等功能
- JavaScript前端逻辑

### 5. config.py - 配置层
- 应用配置参数
- 文件上传限制设置
- 临时目录管理

### 6. server.py - 应用入口
- Flask应用工厂
- 服务器启动配置
- 路由注册

## 已实现功能

### 1. 题库管理功能
- **添加题目**：支持4种题型（单选题、是非题、论述题、计算题）
- **编辑题目**：修改现有题目内容
- **删除题目**：删除不需要的题目
- **导入题目**：从Word文档导入题目（支持标准格式）
- **导出题库**：导出为JSON或CSV格式
- **题目搜索**：按关键词、题型、知识点搜索

### 2. 试卷生成功能
- **题型配置**：灵活配置各题型数量和分值
- **手动选题**：从题库中手动选择题目
- **自动组卷**：一键智能生成试卷，支持动态题型配置
- **试卷预览**：多种预览模式（全中文、全英文、中英对照、带/不带答案）
- **试卷生成**：根据配置生成完整试卷
- **试卷管理**：保存和加载试卷配置

### 3. 高级功能
- **实时总分计算**：动态显示试卷总分
- **题目替换**：在预览界面替换特定题目
- **多语言支持**：中英文双语界面和题目
- **Word导出**：将试卷导出为真正的Word文档（.docx格式），支持样式设置
- **模板下载**：提供标准格式的Word模板
- **动态题型配置**：支持自定义题型，可添加/删除题型配置
- **题库验证**：自动检查题库是否满足试卷配置要求

### 4. 用户界面
- **标签页导航**：题库管理、试卷生成、模板下载
- **响应式设计**：适配不同屏幕尺寸
- **交互反馈**：操作提示和错误处理
- **数据验证**：前端和后端双重验证

### 5. Word导出增强功能
- **真正的Word文档导出**：生成真正的.docx文件，而非浏览器打印功能
- **样式设置**：支持字体、字号、颜色、页面边距等格式设置
- **预览功能**：独立的预览窗口，可实时查看样式效果
- **独立工具**：提供word_exporter.py工具，支持更详细的样式定制

## 技术特点

### 1. 模块化架构
- 采用MVC设计模式
- 高内聚低耦合的模块设计
- 便于维护和扩展

### 2. 前后端分离
- 前端负责界面展示和用户交互
- 后端提供RESTful API服务
- 数据传输采用JSON格式

### 3. 数据持久化
- 内存存储（可扩展为数据库）
- 题目使用统计跟踪
- 试卷配置保存功能

### 4. 安全性
- 文件类型验证
- 输入数据校验
- 错误处理机制

## 系统优势

1. **易维护性**：模块化设计，职责清晰
2. **可扩展性**：预留接口，便于功能扩展
3. **用户友好**：直观的界面和操作流程
4. **功能完整**：涵盖试题管理全流程
5. **双语支持**：满足国际化教学需求

## 部署说明

1. 安装依赖：`pip install flask`
2. 启动服务器：`python server.py`
3. 访问地址：`http://localhost:5000`

## 未来扩展方向

1. 数据库集成（SQLite/MySQL）
2. 用户认证和权限管理
3. 题目分类和标签系统
4. 试卷分析和统计功能
5. 在线考试功能